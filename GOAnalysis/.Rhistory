#Visualization/plot stuff
#Store p-values as named list... ('score(x)' or 'x@score' returns named list of p-val's
#where names are the GO terms)
pval_BP_GO <- score(BP_GO_results)
pval_MF_GO <- score(MF_GO_results)
pval_CC_GO <- score(CC_GO_results)
#plot histogram to see range of p-values
par(mfrow=c(3, 1))
hist(pval_BP_GO, 35, xlab = 'p-values', main = 'Range of BP GO term p-values')
hist(pval_MF_GO, 35, xlab = 'p-values', main = 'Range of BP GO term p-values')
hist(pval_CC_GO, 35, xlab = 'p-values', main = 'Range of BP GO term p-values')
dev.off()
#GenTable to get statistics on GO terms
list_BP_GO_terms <- usedGO(BP_GO_data)
list_MF_GO_terms <- usedGO(MF_GO_data)
list_CC_GO_terms <- usedGO(CC_GO_data)
BP_GO_results_table <- GenTable(BP_GO_data, weightFisher = BP_GO_results, orderBy = 'weightFisher',
topNodes = length(list_BP_GO_terms))
MF_GO_results_table <- GenTable(MF_GO_data, weightFisher = MF_GO_results, orderBy = 'weightFisher',
topNodes = length(list_MF_GO_terms))
CC_GO_results_table <- GenTable(CC_GO_data, weightFisher = CC_GO_results, orderBy = 'weightFisher',
topNodes = length(list_CC_GO_terms))
#Fix Small error in GenTable... weightFisher is listed as CHAR but should be a DOUBLE for sorting purposes later
BP_GO_results_table$weightFisher <- as.double(BP_GO_results_table$weightFisher)
MF_GO_results_table$weightFisher <- as.double(MF_GO_results_table$weightFisher)
CC_GO_results_table$weightFisher <- as.double(CC_GO_results_table$weightFisher)
#Add column for adjusted p_value using p.adjust()
BP_GO_results_table['p_adjusted'] <- p.adjust(BP_GO_results_table$weightFisher, method = 'bonferroni')
MF_GO_results_table['p_adjusted'] <- p.adjust(MF_GO_results_table$weightFisher, method = 'bonferroni')
CC_GO_results_table['p_adjusted'] <- p.adjust(CC_GO_results_table$weightFisher, method = 'bonferroni')
#Write table of all GO terms (both sig and non-sig) to csv file for future use
write.csv(BP_GO_results_table, file = paste(genotype, 'all_genes_BP_GO_terms.csv', sep = '_'), row.names = TRUE)
write.csv(MF_GO_results_table, file = paste(genotype, 'all_genes_MF_GO_terms.csv', sep = '_'), row.names = TRUE)
write.csv(CC_GO_results_table, file = paste(genotype, 'all_genes_CC_GO_terms.csv', sep = '_'), row.names = TRUE)
#Table of only the significant GO terms
BP_sigGO_results_table <- BP_GO_results_table[BP_GO_results_table$p_adjusted <= 0.05, ]
MF_sigGO_results_table <- MF_GO_results_table[MF_GO_results_table$p_adjusted <= 0.05, ]
CC_sigGO_results_table <- CC_GO_results_table[CC_GO_results_table$p_adjusted <= 0.05, ]
#showGroupDensity example for most significant GO term
BP_topSigGO_ID <- BP_GO_results_table[which(BP_GO_results_table$p_adjusted == min(BP_GO_results_table$p_adjusted)),
'GO.ID']
MF_topSigGO_ID <- MF_GO_results_table[which(MF_GO_results_table$p_adjusted == min(MF_GO_results_table$p_adjusted)),
'GO.ID']
CC_topSigGO_ID <- CC_GO_results_table[which(CC_GO_results_table$p_adjusted == min(CC_GO_results_table$p_adjusted)),
'GO.ID']
pdf(file = paste(genotype, 'All_Genes','TopSigGO_Density.pdf', sep = '_'))
showGroupDensity(BP_GO_data, whichGO = BP_topSigGO_ID, ranks = TRUE)
showGroupDensity(MF_GO_data, whichGO = MF_topSigGO_ID, ranks = TRUE)
showGroupDensity(CC_GO_data, whichGO = CC_topSigGO_ID, ranks = TRUE)
dev.off()
#printGraph to plot subgraphs induced by the most significant GO terms...saves to a file
printGraph(BP_GO_data, BP_GO_results, firstSigNodes = 5,
fn.prefix = paste(genotype, 'all_genes','BP_GO', sep = '_'), useInfo = 'all', pdfSW = TRUE)
printGraph(MF_GO_data, MF_GO_results, firstSigNodes = 5,
fn.prefix = paste(genotype, 'all_genes', 'MF_GO', sep = '_'), useInfo = 'all', pdfSW = TRUE)
printGraph(CC_GO_data, CC_GO_results, firstSigNodes = 5,
fn.prefix = paste(genotype, 'all_genes', 'CC_GO', sep = '_'), useInfo = 'all', pdfSW = TRUE)
#Move some files around just to help myself stay organized
file.move(paste(getwd(), '/', genotype, "_All_Genes_TopSigGO_Density.pdf", sep = ''), paste("/Users/bryanmichalek/Documents/Notre_Dame/Spring 2021/Pfrender/GO_Custom_Annotations_Results/", genotype, "_all_genes", sep = ''), overwrite = TRUE)
file.move(paste(getwd(), '/', genotype, "_all_genes_BP_GO_weight01_5_all.pdf", sep = ''), paste("/Users/bryanmichalek/Documents/Notre_Dame/Spring 2021/Pfrender/GO_Custom_Annotations_Results/", genotype, "_all_genes", sep = ''), overwrite = TRUE)
file.move(paste(getwd(), '/', genotype, "_all_genes_MF_GO_weight01_5_all.pdf", sep = ''), paste("/Users/bryanmichalek/Documents/Notre_Dame/Spring 2021/Pfrender/GO_Custom_Annotations_Results/", genotype, "_all_genes", sep = ''), overwrite = TRUE)
file.move(paste(getwd(), '/', genotype, "_all_genes_CC_GO_weight01_5_all.pdf", sep = ''), paste("/Users/bryanmichalek/Documents/Notre_Dame/Spring 2021/Pfrender/GO_Custom_Annotations_Results/", genotype, "_all_genes", sep = ''), overwrite = TRUE)
file.move(paste(getwd(), '/', genotype, "_all_genes_BP_GO_terms.csv", sep = ''), paste("/Users/bryanmichalek/Documents/Notre_Dame/Spring 2021/Pfrender/GO_Custom_Annotations_Results/", genotype, "_all_genes", sep = ''), overwrite = TRUE)
file.move(paste(getwd(), '/', genotype, "_all_genes_MF_GO_terms.csv", sep = ''), paste("/Users/bryanmichalek/Documents/Notre_Dame/Spring 2021/Pfrender/GO_Custom_Annotations_Results/", genotype, "_all_genes", sep = ''), overwrite = TRUE)
file.move(paste(getwd(), '/', genotype, "_all_genes_CC_GO_terms.csv", sep = ''), paste("/Users/bryanmichalek/Documents/Notre_Dame/Spring 2021/Pfrender/GO_Custom_Annotations_Results/", genotype, "_all_genes", sep = ''), overwrite = TRUE)
setwd("~/Documents/Notre_Dame/Spring 2021/Pfrender/GO_Custom_Annotations_Results")
getwd()
setwd("~/Documents/Notre_Dame/Pfrender_GitHub/RNASeqAnalysisPipeline/GOAnalysis")
#if (!requireNamespace("BiocManager", quietly=TRUE))
#   install.packages("BiocManager")
#BiocManager::install('______')
#Load libraries
library(ggplot2)
library(gridExtra)
#Read in data on GO terms (BP, MF, and CC) for each genotype
Y05_BP_GO_terms <- read.csv('/Users/bryanmichalek/Documents/Notre_Dame/Spring 2021/Pfrender/GO_Custom_Annotations_Results/Y05_all_genes/Y05_all_genes_BP_GO_terms.csv', row.names = 1)
Y05_MF_GO_terms <- read.csv('/Users/bryanmichalek/Documents/Notre_Dame/Spring 2021/Pfrender/GO_Custom_Annotations_Results/Y05_all_genes/Y05_all_genes_MF_GO_terms.csv', row.names = 1)
Y05_CC_GO_terms <- read.csv('/Users/bryanmichalek/Documents/Notre_Dame/Spring 2021/Pfrender/GO_Custom_Annotations_Results/Y05_all_genes/Y05_all_genes_CC_GO_terms.csv', row.names = 1)
Y023_BP_GO_terms <- read.csv('/Users/bryanmichalek/Documents/Notre_Dame/Spring 2021/Pfrender/GO_Custom_Annotations_Results/Y023_all_genes/Y023_all_genes_BP_GO_terms.csv', row.names = 1)
Y023_MF_GO_terms <- read.csv('/Users/bryanmichalek/Documents/Notre_Dame/Spring 2021/Pfrender/GO_Custom_Annotations_Results/Y023_all_genes/Y023_all_genes_MF_GO_terms.csv', row.names = 1)
Y023_CC_GO_terms <- read.csv('/Users/bryanmichalek/Documents/Notre_Dame/Spring 2021/Pfrender/GO_Custom_Annotations_Results/Y023_all_genes/Y023_all_genes_CC_GO_terms.csv', row.names = 1)
E05_BP_GO_terms <- read.csv('/Users/bryanmichalek/Documents/Notre_Dame/Spring 2021/Pfrender/GO_Custom_Annotations_Results/E05_all_genes/E05_all_genes_BP_GO_terms.csv', row.names = 1)
E05_MF_GO_terms <- read.csv('/Users/bryanmichalek/Documents/Notre_Dame/Spring 2021/Pfrender/GO_Custom_Annotations_Results/E05_all_genes/E05_all_genes_MF_GO_terms.csv', row.names = 1)
E05_CC_GO_terms <- read.csv('/Users/bryanmichalek/Documents/Notre_Dame/Spring 2021/Pfrender/GO_Custom_Annotations_Results/E05_all_genes/E05_all_genes_CC_GO_terms.csv', row.names = 1)
R2_BP_GO_terms <- read.csv('/Users/bryanmichalek/Documents/Notre_Dame/Spring 2021/Pfrender/GO_Custom_Annotations_Results/R2_all_genes/R2_all_genes_BP_GO_terms.csv', row.names = 1)
R2_MF_GO_terms <- read.csv('/Users/bryanmichalek/Documents/Notre_Dame/Spring 2021/Pfrender/GO_Custom_Annotations_Results/R2_all_genes/R2_all_genes_MF_GO_terms.csv', row.names = 1)
R2_CC_GO_terms <- read.csv('/Users/bryanmichalek/Documents/Notre_Dame/Spring 2021/Pfrender/GO_Custom_Annotations_Results/R2_all_genes/R2_all_genes_CC_GO_terms.csv', row.names = 1)
PA_BP_GO_terms <- read.csv('/Users/bryanmichalek/Documents/Notre_Dame/Spring 2021/Pfrender/GO_Custom_Annotations_Results/PA_all_genes/PA_all_genes_BP_GO_terms.csv', row.names = 1)
PA_MF_GO_terms <- read.csv('/Users/bryanmichalek/Documents/Notre_Dame/Spring 2021/Pfrender/GO_Custom_Annotations_Results/PA_all_genes/PA_all_genes_MF_GO_terms.csv', row.names = 1)
PA_CC_GO_terms <- read.csv('/Users/bryanmichalek/Documents/Notre_Dame/Spring 2021/Pfrender/GO_Custom_Annotations_Results/PA_all_genes/PA_all_genes_CC_GO_terms.csv', row.names = 1)
Sierra_BP_GO_terms <- read.csv('/Users/bryanmichalek/Documents/Notre_Dame/Spring 2021/Pfrender/GO_Custom_Annotations_Results/Sierra_all_genes/Sierra_all_genes_BP_GO_terms.csv', row.names = 1)
Sierra_MF_GO_terms <- read.csv('/Users/bryanmichalek/Documents/Notre_Dame/Spring 2021/Pfrender/GO_Custom_Annotations_Results/Sierra_all_genes/Sierra_all_genes_MF_GO_terms.csv', row.names = 1)
Sierra_CC_GO_terms <- read.csv('/Users/bryanmichalek/Documents/Notre_Dame/Spring 2021/Pfrender/GO_Custom_Annotations_Results/Sierra_all_genes/Sierra_all_genes_CC_GO_terms.csv', row.names = 1)
#--------------------------------------------------------------------------------------------------
#ALL BP WORK
#Filter for top 5 significant in each (get the 1st 5 rows...then take only the significant ones).
#They should already be in decreasing significance order.
Y05_BP_GO_top5 <- Y05_BP_GO_terms[1:5, ]
Y023_BP_GO_top5 <- Y023_BP_GO_terms[1:5, ]
E05_BP_GO_top5 <- E05_BP_GO_terms[1:5, ]
R2_BP_GO_top5 <- R2_BP_GO_terms[1:5, ]
PA_BP_GO_top5 <- PA_BP_GO_terms[1:5, ]
Sierra_BP_GO_top5 <- Sierra_BP_GO_terms[1:5, ]
Y05_BP_GO_sig <- Y05_BP_GO_top5[which(Y05_BP_GO_top5$p_adjusted <= 0.05), ]
Y023_BP_GO_sig <- Y023_BP_GO_top5[which(Y023_BP_GO_top5$p_adjusted <= 0.05), ]
E05_BP_GO_sig <- E05_BP_GO_top5[which(E05_BP_GO_top5$p_adjusted <= 0.05), ]
R2_BP_GO_sig <- R2_BP_GO_top5[which(R2_BP_GO_top5$p_adjusted <= 0.05), ]
PA_BP_GO_sig <- PA_BP_GO_top5[which(PA_BP_GO_top5$p_adjusted <= 0.05), ]
Sierra_BP_GO_sig <- Sierra_BP_GO_top5[which(Sierra_BP_GO_top5$p_adjusted <= 0.05), ]
#List of all 30 BP for each genotype (duplicates removed)
list_all_BP_GO_included <- unique(c(Y05_BP_GO_sig$GO.ID, Y023_BP_GO_sig$GO.ID, E05_BP_GO_sig$GO.ID,
R2_BP_GO_sig$GO.ID, PA_BP_GO_sig$GO.ID, Sierra_BP_GO_sig$GO.ID))
#Add a column labeling the genotype to each
Y05_BP_plot_table <- cbind("Genotype" = 'Y05', Y05_BP_GO_sig)
Y023_BP_plot_table <- cbind("Genotype" = 'Y023', Y023_BP_GO_sig)
E05_BP_plot_table <- cbind("Genotype" = 'E05', E05_BP_GO_sig)
#R2_BP_plot_table <- cbind("Genotype" = 'R2', R2_BP_GO_sig)
PA_BP_plot_table <- cbind("Genotype" = 'PA', PA_BP_GO_sig)
Sierra_BP_plot_table <- cbind("Genotype" = 'Sierra', Sierra_BP_GO_sig)
#--------------------------------------------------------------------------------------------------
#ALL MF WORK
#Filter for top 5 significant in each (get the 1st 5 rows...then take only the significant ones).
#They should already be in decreasing significance order.
Y05_MF_GO_top5 <- Y05_MF_GO_terms[1:5, ]
Y023_MF_GO_top5 <- Y023_MF_GO_terms[1:5, ]
E05_MF_GO_top5 <- E05_MF_GO_terms[1:5, ]
R2_MF_GO_top5 <- R2_MF_GO_terms[1:5, ]
PA_MF_GO_top5 <- PA_MF_GO_terms[1:5, ]
Sierra_MF_GO_top5 <- Sierra_MF_GO_terms[1:5, ]
Y05_MF_GO_sig <- Y05_MF_GO_top5[which(Y05_MF_GO_top5$p_adjusted <= 0.05), ]
Y023_MF_GO_sig <- Y023_MF_GO_top5[which(Y023_MF_GO_top5$p_adjusted <= 0.05), ]
E05_MF_GO_sig <- E05_MF_GO_top5[which(E05_MF_GO_top5$p_adjusted <= 0.05), ]
R2_MF_GO_sig <- R2_MF_GO_top5[which(R2_MF_GO_top5$p_adjusted <= 0.05), ]
PA_MF_GO_sig <- PA_MF_GO_top5[which(PA_MF_GO_top5$p_adjusted <= 0.05), ]
Sierra_MF_GO_sig <- Sierra_MF_GO_top5[which(Sierra_MF_GO_top5$p_adjusted <= 0.05), ]
#List of all 30 MF for each genotype (duplicates removed)
list_all_MF_GO_included <- unique(c(Y05_MF_GO_sig$GO.ID, Y023_MF_GO_sig$GO.ID, E05_MF_GO_sig$GO.ID,
R2_MF_GO_sig$GO.ID, PA_MF_GO_sig$GO.ID, Sierra_MF_GO_sig$GO.ID))
#Add a column labeling the genotype to each
Y05_MF_plot_table <- cbind("Genotype" = 'Y05', Y05_MF_GO_sig)
Y023_MF_plot_table <- cbind("Genotype" = 'Y023', Y023_MF_GO_sig)
E05_MF_plot_table <- cbind("Genotype" = 'E05', E05_MF_GO_sig)
R2_MF_plot_table <- cbind("Genotype" = 'R2', R2_MF_GO_sig)
PA_MF_plot_table <- cbind("Genotype" = 'PA', PA_MF_GO_sig)
Sierra_MF_plot_table <- cbind("Genotype" = 'Sierra', Sierra_MF_GO_sig)
#--------------------------------------------------------------------------------------------------
#ALL CC WORK
#Filter for top 5 significant in each (get the 1st 5 rows...then take only the significant ones).
#They should already be in decreasing significance order.
Y05_CC_GO_top5 <- Y05_CC_GO_terms[1:5, ]
Y023_CC_GO_top5 <- Y023_CC_GO_terms[1:5, ]
E05_CC_GO_top5 <- E05_CC_GO_terms[1:5, ]
R2_CC_GO_top5 <- R2_CC_GO_terms[1:5, ]
PA_CC_GO_top5 <- PA_CC_GO_terms[1:5, ]
Sierra_CC_GO_top5 <- Sierra_CC_GO_terms[1:5, ]
Y05_CC_GO_sig <- Y05_CC_GO_top5[which(Y05_CC_GO_top5$p_adjusted <= 0.05), ]
Y023_CC_GO_sig <- Y023_CC_GO_top5[which(Y023_CC_GO_top5$p_adjusted <= 0.05), ]
E05_CC_GO_sig <- E05_CC_GO_top5[which(E05_CC_GO_top5$p_adjusted <= 0.05), ]
R2_CC_GO_sig <- R2_CC_GO_top5[which(R2_CC_GO_top5$p_adjusted <= 0.05), ]
PA_CC_GO_sig <- PA_CC_GO_top5[which(PA_CC_GO_top5$p_adjusted <= 0.05), ]
Sierra_CC_GO_sig <- Sierra_CC_GO_top5[which(Sierra_CC_GO_top5$p_adjusted <= 0.05), ]
#List of all 30 CC for each genotype (duplicates removed)
list_all_CC_GO_included <- unique(c(Y05_CC_GO_sig$GO.ID, Y023_CC_GO_sig$GO.ID, E05_CC_GO_sig$GO.ID,
R2_CC_GO_sig$GO.ID, PA_CC_GO_sig$GO.ID, Sierra_CC_GO_sig$GO.ID))
#Add a column labeling the genotype to each
Y05_CC_plot_table <- cbind("Genotype" = 'Y05', Y05_CC_GO_sig)
Y023_CC_plot_table <- cbind("Genotype" = 'Y023', Y023_CC_GO_sig)
E05_CC_plot_table <- cbind("Genotype" = 'E05', E05_CC_GO_sig)
#R2_CC_plot_table <- cbind("Genotype" = 'R2', R2_CC_GO_sig)
PA_CC_plot_table <- cbind("Genotype" = 'PA', PA_CC_GO_sig)
Sierra_CC_plot_table <- cbind("Genotype" = 'Sierra', Sierra_CC_GO_sig)
#--------------------------------------------------------------------------------------------------
#Combine all tables into 1
all_genotype_BP_plot_table <- rbind(Y05_BP_plot_table, Y023_BP_plot_table, E05_BP_plot_table, PA_BP_plot_table,
Sierra_BP_plot_table)
all_genotype_BP_plot_table <- cbind('GO_cat' = 'BP', all_genotype_BP_plot_table)
all_genotype_MF_plot_table <- rbind(Y05_MF_plot_table, Y023_MF_plot_table, E05_MF_plot_table, R2_MF_plot_table, PA_MF_plot_table,
Sierra_MF_plot_table)
all_genotype_MF_plot_table <- cbind('GO_cat' = 'MF', all_genotype_MF_plot_table)
all_genotype_CC_plot_table <- rbind(Y05_CC_plot_table, Y023_CC_plot_table, E05_CC_plot_table, PA_CC_plot_table,
Sierra_CC_plot_table)
all_genotype_CC_plot_table <- cbind('GO_cat' = 'CC', all_genotype_CC_plot_table)
all_genotype_plot_table <- rbind(all_genotype_BP_plot_table, all_genotype_MF_plot_table, all_genotype_CC_plot_table)
#--------------------------------------------------------------------------------------------------
#Make plot
x_axis_order <- factor(all_genotype_plot_table$Genotype, levels = c('Y05', 'Y023', 'E05', 'R2', 'PA', 'Sierra'))
facet <- factor(all_genotype_plot_table$GO_cat, levels = c('BP', 'MF', 'CC'))
p <- ggplot(data = all_genotype_plot_table, aes(x = x_axis_order, y = Term, size = Significant, color = p_adjusted))
p <- p + facet_grid(rows = facet, space = 'free_y', scales = 'free')
p <- p + geom_point() + scale_color_gradientn(colors = heat.colors(10), limits=c(0, 0.05)) + theme_bw()
p <- p + xlab('Genotype') + ylab('GO Term')
p <- p + labs(color = 'Adjusted p-value', size = 'Gene rank')
#--------------------------------------------------------------------------------------------------
#Save to file
final_plot <- p
ggsave('GOenrich_Dotplot_OnlySig_CustomAnnotation_AllGenes.pdf', plot = final_plot, device = 'pdf')
file.move(paste(getwd(), '/', "GOenrich_Dotplot_OnlySig_CustomAnnotation_AllGenes.pdf", sep = ''), "/Users/bryanmichalek/Documents/Notre_Dame/Spring 2021/Pfrender/GO_Custom_Annotations_Results/", overwrite = TRUE)
#same plot but with gray non significant GO terms
#same plot but with Olympic ANOVA results on x-axis
#add to each of these plots a column of UV associated genes (from drosophila and red flower beetle)
#Load libraries
library(ggplot2)
library(gridExtra)
#Read in data on GO terms (BP, MF, and CC) for each genotype
Y05_BP_GO_terms <- read.csv('/Users/bryanmichalek/Documents/Notre_Dame/Spring 2021/Pfrender/GO_Custom_Annotations_Results/Y05_all_genes/Y05_all_genes_BP_GO_terms.csv', row.names = 1)
Y05_MF_GO_terms <- read.csv('/Users/bryanmichalek/Documents/Notre_Dame/Spring 2021/Pfrender/GO_Custom_Annotations_Results/Y05_all_genes/Y05_all_genes_MF_GO_terms.csv', row.names = 1)
Y05_CC_GO_terms <- read.csv('/Users/bryanmichalek/Documents/Notre_Dame/Spring 2021/Pfrender/GO_Custom_Annotations_Results/Y05_all_genes/Y05_all_genes_CC_GO_terms.csv', row.names = 1)
Y023_BP_GO_terms <- read.csv('/Users/bryanmichalek/Documents/Notre_Dame/Spring 2021/Pfrender/GO_Custom_Annotations_Results/Y023_all_genes/Y023_all_genes_BP_GO_terms.csv', row.names = 1)
Y023_MF_GO_terms <- read.csv('/Users/bryanmichalek/Documents/Notre_Dame/Spring 2021/Pfrender/GO_Custom_Annotations_Results/Y023_all_genes/Y023_all_genes_MF_GO_terms.csv', row.names = 1)
Y023_CC_GO_terms <- read.csv('/Users/bryanmichalek/Documents/Notre_Dame/Spring 2021/Pfrender/GO_Custom_Annotations_Results/Y023_all_genes/Y023_all_genes_CC_GO_terms.csv', row.names = 1)
E05_BP_GO_terms <- read.csv('/Users/bryanmichalek/Documents/Notre_Dame/Spring 2021/Pfrender/GO_Custom_Annotations_Results/E05_all_genes/E05_all_genes_BP_GO_terms.csv', row.names = 1)
E05_MF_GO_terms <- read.csv('/Users/bryanmichalek/Documents/Notre_Dame/Spring 2021/Pfrender/GO_Custom_Annotations_Results/E05_all_genes/E05_all_genes_MF_GO_terms.csv', row.names = 1)
E05_CC_GO_terms <- read.csv('/Users/bryanmichalek/Documents/Notre_Dame/Spring 2021/Pfrender/GO_Custom_Annotations_Results/E05_all_genes/E05_all_genes_CC_GO_terms.csv', row.names = 1)
R2_BP_GO_terms <- read.csv('/Users/bryanmichalek/Documents/Notre_Dame/Spring 2021/Pfrender/GO_Custom_Annotations_Results/R2_all_genes/R2_all_genes_BP_GO_terms.csv', row.names = 1)
R2_MF_GO_terms <- read.csv('/Users/bryanmichalek/Documents/Notre_Dame/Spring 2021/Pfrender/GO_Custom_Annotations_Results/R2_all_genes/R2_all_genes_MF_GO_terms.csv', row.names = 1)
R2_CC_GO_terms <- read.csv('/Users/bryanmichalek/Documents/Notre_Dame/Spring 2021/Pfrender/GO_Custom_Annotations_Results/R2_all_genes/R2_all_genes_CC_GO_terms.csv', row.names = 1)
PA_BP_GO_terms <- read.csv('/Users/bryanmichalek/Documents/Notre_Dame/Spring 2021/Pfrender/GO_Custom_Annotations_Results/PA_all_genes/PA_all_genes_BP_GO_terms.csv', row.names = 1)
PA_MF_GO_terms <- read.csv('/Users/bryanmichalek/Documents/Notre_Dame/Spring 2021/Pfrender/GO_Custom_Annotations_Results/PA_all_genes/PA_all_genes_MF_GO_terms.csv', row.names = 1)
PA_CC_GO_terms <- read.csv('/Users/bryanmichalek/Documents/Notre_Dame/Spring 2021/Pfrender/GO_Custom_Annotations_Results/PA_all_genes/PA_all_genes_CC_GO_terms.csv', row.names = 1)
Sierra_BP_GO_terms <- read.csv('/Users/bryanmichalek/Documents/Notre_Dame/Spring 2021/Pfrender/GO_Custom_Annotations_Results/Sierra_all_genes/Sierra_all_genes_BP_GO_terms.csv', row.names = 1)
Sierra_MF_GO_terms <- read.csv('/Users/bryanmichalek/Documents/Notre_Dame/Spring 2021/Pfrender/GO_Custom_Annotations_Results/Sierra_all_genes/Sierra_all_genes_MF_GO_terms.csv', row.names = 1)
Sierra_CC_GO_terms <- read.csv('/Users/bryanmichalek/Documents/Notre_Dame/Spring 2021/Pfrender/GO_Custom_Annotations_Results/Sierra_all_genes/Sierra_all_genes_CC_GO_terms.csv', row.names = 1)
#ALL BP WORK
#Filter for top 5 significant in each (get the 1st 5 rows...then take only the significant ones).
#They should already be in decreasing significance order.
Y05_BP_GO_top5 <- Y05_BP_GO_terms[1:5, ]
Y023_BP_GO_top5 <- Y023_BP_GO_terms[1:5, ]
E05_BP_GO_top5 <- E05_BP_GO_terms[1:5, ]
R2_BP_GO_top5 <- R2_BP_GO_terms[1:5, ]
PA_BP_GO_top5 <- PA_BP_GO_terms[1:5, ]
Sierra_BP_GO_top5 <- Sierra_BP_GO_terms[1:5, ]
Y05_BP_GO_sig <- Y05_BP_GO_top5[which(Y05_BP_GO_top5$p_adjusted <= 0.05), ]
Y023_BP_GO_sig <- Y023_BP_GO_top5[which(Y023_BP_GO_top5$p_adjusted <= 0.05), ]
E05_BP_GO_sig <- E05_BP_GO_top5[which(E05_BP_GO_top5$p_adjusted <= 0.05), ]
R2_BP_GO_sig <- R2_BP_GO_top5[which(R2_BP_GO_top5$p_adjusted <= 0.05), ]
PA_BP_GO_sig <- PA_BP_GO_top5[which(PA_BP_GO_top5$p_adjusted <= 0.05), ]
Sierra_BP_GO_sig <- Sierra_BP_GO_top5[which(Sierra_BP_GO_top5$p_adjusted <= 0.05), ]
#List of all 30 BP for each genotype (duplicates removed)
list_all_BP_GO_included <- unique(c(Y05_BP_GO_sig$GO.ID, Y023_BP_GO_sig$GO.ID, E05_BP_GO_sig$GO.ID,
R2_BP_GO_sig$GO.ID, PA_BP_GO_sig$GO.ID, Sierra_BP_GO_sig$GO.ID))
#Create tables with all the info for plot for each genotype
Y05_BP_plot_table <- Y05_BP_GO_terms[which(Y05_BP_GO_terms$GO.ID %in% list_all_BP_GO_included), ]
Y023_BP_plot_table <- Y023_BP_GO_terms[which(Y023_BP_GO_terms$GO.ID %in% list_all_BP_GO_included), ]
E05_BP_plot_table <- E05_BP_GO_terms[which(E05_BP_GO_terms$GO.ID %in% list_all_BP_GO_included), ]
R2_BP_plot_table <- R2_BP_GO_terms[which(R2_BP_GO_terms$GO.ID %in% list_all_BP_GO_included), ]
PA_BP_plot_table <- PA_BP_GO_terms[which(PA_BP_GO_terms$GO.ID %in% list_all_BP_GO_included), ]
Sierra_BP_plot_table <- Sierra_BP_GO_terms[which(Sierra_BP_GO_terms$GO.ID %in% list_all_BP_GO_included), ]
View(Y05_BP_plot_table)
View(Sierra_BP_plot_table)
#Add a column labeling the genotype to each
Y05_BP_plot_table <- cbind("Genotype" = 'Y05', Y05_BP_GO_plot_table)
Y023_BP_plot_table <- cbind("Genotype" = 'Y023', Y023_BP_GO_plot_table)
E05_BP_plot_table <- cbind("Genotype" = 'E05', E05_BP_GO_plot_table)
R2_BP_plot_table <- cbind("Genotype" = 'R2', R2_BP_GO_plot_table)
PA_BP_plot_table <- cbind("Genotype" = 'PA', PA_BP_GO_plot_table)
Sierra_BP_plot_table <- cbind("Genotype" = 'Sierra', Sierra_BP_GO_plot_table)
#---
#Add a column labeling the genotype to each
Y05_BP_plot_table <- cbind("Genotype" = 'Y05', Y05_BP_plot_table)
Y023_BP_plot_table <- cbind("Genotype" = 'Y023', Y023_BP_plot_table)
E05_BP_plot_table <- cbind("Genotype" = 'E05', E05_BP_plot_table)
R2_BP_plot_table <- cbind("Genotype" = 'R2', R2_BP_plot_table)
PA_BP_plot_table <- cbind("Genotype" = 'PA', PA_BP_plot_table)
Sierra_BP_plot_table <- cbind("Genotype" = 'Sierra', Sierra_BP_plot_table)
View(Y023_BP_plot_table)
#ALL MF WORK
#Filter for top 5 significant in each (get the 1st 5 rows...then take only the significant ones).
#They should already be in decreasing significance order.
Y05_MF_GO_top5 <- Y05_MF_GO_terms[1:5, ]
Y023_MF_GO_top5 <- Y023_MF_GO_terms[1:5, ]
E05_MF_GO_top5 <- E05_MF_GO_terms[1:5, ]
R2_MF_GO_top5 <- R2_MF_GO_terms[1:5, ]
PA_MF_GO_top5 <- PA_MF_GO_terms[1:5, ]
Sierra_MF_GO_top5 <- Sierra_MF_GO_terms[1:5, ]
Y05_MF_GO_sig <- Y05_MF_GO_top5[which(Y05_MF_GO_top5$p_adjusted <= 0.05), ]
Y023_MF_GO_sig <- Y023_MF_GO_top5[which(Y023_MF_GO_top5$p_adjusted <= 0.05), ]
E05_MF_GO_sig <- E05_MF_GO_top5[which(E05_MF_GO_top5$p_adjusted <= 0.05), ]
R2_MF_GO_sig <- R2_MF_GO_top5[which(R2_MF_GO_top5$p_adjusted <= 0.05), ]
PA_MF_GO_sig <- PA_MF_GO_top5[which(PA_MF_GO_top5$p_adjusted <= 0.05), ]
Sierra_MF_GO_sig <- Sierra_MF_GO_top5[which(Sierra_MF_GO_top5$p_adjusted <= 0.05), ]
#List of all 30 MF for each genotype (duplicates removed)
list_all_MF_GO_included <- unique(c(Y05_MF_GO_sig$GO.ID, Y023_MF_GO_sig$GO.ID, E05_MF_GO_sig$GO.ID,
R2_MF_GO_sig$GO.ID, PA_MF_GO_sig$GO.ID, Sierra_MF_GO_sig$GO.ID))
#Create tables with all the info for plot for each genotype
Y05_MF_plot_table <- Y05_MF_GO_terms[which(Y05_MF_GO_terms$GO.ID %in% list_all_MF_GO_included), ]
Y023_MF_plot_table <- Y023_MF_GO_terms[which(Y023_MF_GO_terms$GO.ID %in% list_all_MF_GO_included), ]
E05_MF_plot_table <- E05_MF_GO_terms[which(E05_MF_GO_terms$GO.ID %in% list_all_MF_GO_included), ]
R2_MF_plot_table <- R2_MF_GO_terms[which(R2_MF_GO_terms$GO.ID %in% list_all_MF_GO_included), ]
PA_MF_plot_table <- PA_MF_GO_terms[which(PA_MF_GO_terms$GO.ID %in% list_all_MF_GO_included), ]
Sierra_MF_plot_table <- Sierra_MF_GO_terms[which(Sierra_MF_GO_terms$GO.ID %in% list_all_MF_GO_included), ]
#Add a column labeling the genotype to each
Y05_MF_plot_table <- cbind("Genotype" = 'Y05', Y05_MF_plot_table)
Y023_MF_plot_table <- cbind("Genotype" = 'Y023', Y023_MF_plot_table)
E05_MF_plot_table <- cbind("Genotype" = 'E05', E05_MF_plot_table)
R2_MF_plot_table <- cbind("Genotype" = 'R2', R2_MF_plot_table)
PA_MF_plot_table <- cbind("Genotype" = 'PA', PA_MF_plot_table)
Sierra_MF_plot_table <- cbind("Genotype" = 'Sierra', Sierra_MF_plot_table)
#ALL CC WORK
#Filter for top 5 significant in each (get the 1st 5 rows...then take only the significant ones).
#They should already be in decreasing significance order.
Y05_CC_GO_top5 <- Y05_CC_GO_terms[1:5, ]
Y023_CC_GO_top5 <- Y023_CC_GO_terms[1:5, ]
E05_CC_GO_top5 <- E05_CC_GO_terms[1:5, ]
R2_CC_GO_top5 <- R2_CC_GO_terms[1:5, ]
PA_CC_GO_top5 <- PA_CC_GO_terms[1:5, ]
Sierra_CC_GO_top5 <- Sierra_CC_GO_terms[1:5, ]
Y05_CC_GO_sig <- Y05_CC_GO_top5[which(Y05_CC_GO_top5$p_adjusted <= 0.05), ]
Y023_CC_GO_sig <- Y023_CC_GO_top5[which(Y023_CC_GO_top5$p_adjusted <= 0.05), ]
E05_CC_GO_sig <- E05_CC_GO_top5[which(E05_CC_GO_top5$p_adjusted <= 0.05), ]
R2_CC_GO_sig <- R2_CC_GO_top5[which(R2_CC_GO_top5$p_adjusted <= 0.05), ]
PA_CC_GO_sig <- PA_CC_GO_top5[which(PA_CC_GO_top5$p_adjusted <= 0.05), ]
Sierra_CC_GO_sig <- Sierra_CC_GO_top5[which(Sierra_CC_GO_top5$p_adjusted <= 0.05), ]
#List of all 30 CC for each genotype (duplicates removed)
list_all_CC_GO_included <- unique(c(Y05_CC_GO_sig$GO.ID, Y023_CC_GO_sig$GO.ID, E05_CC_GO_sig$GO.ID,
R2_CC_GO_sig$GO.ID, PA_CC_GO_sig$GO.ID, Sierra_CC_GO_sig$GO.ID))
#Create tables with all the info for plot for each genotype
Y05_CC_plot_table <- Y05_CC_GO_terms[which(Y05_CC_GO_terms$GO.ID %in% list_all_CC_GO_included), ]
Y023_CC_plot_table <- Y023_CC_GO_terms[which(Y023_CC_GO_terms$GO.ID %in% list_all_CC_GO_included), ]
E05_CC_plot_table <- E05_CC_GO_terms[which(E05_CC_GO_terms$GO.ID %in% list_all_CC_GO_included), ]
R2_CC_plot_table <- R2_CC_GO_terms[which(R2_CC_GO_terms$GO.ID %in% list_all_CC_GO_included), ]
PA_CC_plot_table <- PA_CC_GO_terms[which(PA_CC_GO_terms$GO.ID %in% list_all_CC_GO_included), ]
Sierra_CC_plot_table <- Sierra_CC_GO_terms[which(Sierra_CC_GO_terms$GO.ID %in% list_all_CC_GO_included), ]
#Add a column labeling the genotype to each
Y05_CC_plot_table <- cbind("Genotype" = 'Y05', Y05_CC_plot_table)
Y023_CC_plot_table <- cbind("Genotype" = 'Y023', Y023_CC_plot_table)
E05_CC_plot_table <- cbind("Genotype" = 'E05', E05_CC_plot_table)
R2_CC_plot_table <- cbind("Genotype" = 'R2', R2_CC_plot_table)
PA_CC_plot_table <- cbind("Genotype" = 'PA', PA_CC_plot_table)
Sierra_CC_plot_table <- cbind("Genotype" = 'Sierra', Sierra_CC_plot_table)
#Combine all tables into 1
all_genotype_BP_plot_table <- rbind(Y05_BP_plot_table, Y023_BP_plot_table, E05_BP_plot_table, R2_BP_plot_table, PA_BP_plot_table,
Sierra_BP_plot_table)
all_genotype_BP_plot_table <- cbind('GO_cat' = 'BP', all_genotype_BP_plot_table)
all_genotype_MF_plot_table <- rbind(Y05_MF_plot_table, Y023_MF_plot_table, E05_MF_plot_table, R2_MF_plot_table, PA_MF_plot_table,
Sierra_MF_plot_table)
all_genotype_MF_plot_table <- cbind('GO_cat' = 'MF', all_genotype_MF_plot_table)
all_genotype_CC_plot_table <- rbind(Y05_CC_plot_table, Y023_CC_plot_table, E05_CC_plot_table, R2_BP_plot_table, PA_CC_plot_table,
Sierra_CC_plot_table)
all_genotype_CC_plot_table <- cbind('GO_cat' = 'CC', all_genotype_CC_plot_table)
all_genotype_plot_table <- rbind(all_genotype_BP_plot_table, all_genotype_MF_plot_table, all_genotype_CC_plot_table)
View(all_genotype_plot_table)
#Make plot
x_axis_order <- factor(all_genotype_plot_table$Genotype, levels = c('Y05', 'Y023', 'E05', 'R2', 'PA', 'Sierra'))
facet <- factor(all_genotype_plot_table$GO_cat, levels = c('BP', 'MF', 'CC'))
p <- ggplot(data = all_genotype_plot_table, aes(x = x_axis_order, y = Term, size = Significant, color = p_adjusted))
p <- p + facet_grid(rows = facet, space = 'free_y', scales = 'free')
p <- p + geom_point() + scale_color_gradientn(colors = heat.colors(10), limits=c(0, 0.05)) + theme_bw()
p <- p + xlab('Genotype') + ylab('GO Term')
p <- p + labs(color = 'Adjusted p-value', size = 'Gene rank')
#--------------------------------------------------------------------------------------------------
#Save to file
final_plot <- p
ggsave('GOenrich_Dotplot_CustomAnnotation_AllGenes.pdf', plot = final_plot, device = 'pdf')
file.move(paste(getwd(), '/', "GOenrich_Dotplot_CustomAnnotation_AllGenes.pdf", sep = ''), "/Users/bryanmichalek/Documents/Notre_Dame/Spring 2021/Pfrender/GO_Custom_Annotations_Results/", overwrite = TRUE)
list_all_CC_GO_included
length(list_all_MF_GO_included)
length(list_all_CC_GO_included)
length(list_all_BP_GO_included)
View(all_genotype_plot_table)
which(all_genotype_plot_table$Term == "chitin metabolic process")
all_genotype_plot_table[which(all_genotype_plot_table$Term == "chitin metabolic process"), ]
View(all_genotype_CC_plot_table)
#if (!requireNamespace("BiocManager", quietly=TRUE))
#   install.packages("BiocManager")
#BiocManager::install('______')
#Load libraries
library(ggplot2)
library(gridExtra)
#Read in data on GO terms (BP, MF, and CC) for each genotype
Y05_BP_GO_terms <- read.csv('/Users/bryanmichalek/Documents/Notre_Dame/Spring 2021/Pfrender/GO_Custom_Annotations_Results/Y05_all_genes/Y05_all_genes_BP_GO_terms.csv', row.names = 1)
Y05_MF_GO_terms <- read.csv('/Users/bryanmichalek/Documents/Notre_Dame/Spring 2021/Pfrender/GO_Custom_Annotations_Results/Y05_all_genes/Y05_all_genes_MF_GO_terms.csv', row.names = 1)
Y05_CC_GO_terms <- read.csv('/Users/bryanmichalek/Documents/Notre_Dame/Spring 2021/Pfrender/GO_Custom_Annotations_Results/Y05_all_genes/Y05_all_genes_CC_GO_terms.csv', row.names = 1)
Y023_BP_GO_terms <- read.csv('/Users/bryanmichalek/Documents/Notre_Dame/Spring 2021/Pfrender/GO_Custom_Annotations_Results/Y023_all_genes/Y023_all_genes_BP_GO_terms.csv', row.names = 1)
Y023_MF_GO_terms <- read.csv('/Users/bryanmichalek/Documents/Notre_Dame/Spring 2021/Pfrender/GO_Custom_Annotations_Results/Y023_all_genes/Y023_all_genes_MF_GO_terms.csv', row.names = 1)
Y023_CC_GO_terms <- read.csv('/Users/bryanmichalek/Documents/Notre_Dame/Spring 2021/Pfrender/GO_Custom_Annotations_Results/Y023_all_genes/Y023_all_genes_CC_GO_terms.csv', row.names = 1)
E05_BP_GO_terms <- read.csv('/Users/bryanmichalek/Documents/Notre_Dame/Spring 2021/Pfrender/GO_Custom_Annotations_Results/E05_all_genes/E05_all_genes_BP_GO_terms.csv', row.names = 1)
E05_MF_GO_terms <- read.csv('/Users/bryanmichalek/Documents/Notre_Dame/Spring 2021/Pfrender/GO_Custom_Annotations_Results/E05_all_genes/E05_all_genes_MF_GO_terms.csv', row.names = 1)
E05_CC_GO_terms <- read.csv('/Users/bryanmichalek/Documents/Notre_Dame/Spring 2021/Pfrender/GO_Custom_Annotations_Results/E05_all_genes/E05_all_genes_CC_GO_terms.csv', row.names = 1)
R2_BP_GO_terms <- read.csv('/Users/bryanmichalek/Documents/Notre_Dame/Spring 2021/Pfrender/GO_Custom_Annotations_Results/R2_all_genes/R2_all_genes_BP_GO_terms.csv', row.names = 1)
R2_MF_GO_terms <- read.csv('/Users/bryanmichalek/Documents/Notre_Dame/Spring 2021/Pfrender/GO_Custom_Annotations_Results/R2_all_genes/R2_all_genes_MF_GO_terms.csv', row.names = 1)
R2_CC_GO_terms <- read.csv('/Users/bryanmichalek/Documents/Notre_Dame/Spring 2021/Pfrender/GO_Custom_Annotations_Results/R2_all_genes/R2_all_genes_CC_GO_terms.csv', row.names = 1)
PA_BP_GO_terms <- read.csv('/Users/bryanmichalek/Documents/Notre_Dame/Spring 2021/Pfrender/GO_Custom_Annotations_Results/PA_all_genes/PA_all_genes_BP_GO_terms.csv', row.names = 1)
PA_MF_GO_terms <- read.csv('/Users/bryanmichalek/Documents/Notre_Dame/Spring 2021/Pfrender/GO_Custom_Annotations_Results/PA_all_genes/PA_all_genes_MF_GO_terms.csv', row.names = 1)
PA_CC_GO_terms <- read.csv('/Users/bryanmichalek/Documents/Notre_Dame/Spring 2021/Pfrender/GO_Custom_Annotations_Results/PA_all_genes/PA_all_genes_CC_GO_terms.csv', row.names = 1)
Sierra_BP_GO_terms <- read.csv('/Users/bryanmichalek/Documents/Notre_Dame/Spring 2021/Pfrender/GO_Custom_Annotations_Results/Sierra_all_genes/Sierra_all_genes_BP_GO_terms.csv', row.names = 1)
Sierra_MF_GO_terms <- read.csv('/Users/bryanmichalek/Documents/Notre_Dame/Spring 2021/Pfrender/GO_Custom_Annotations_Results/Sierra_all_genes/Sierra_all_genes_MF_GO_terms.csv', row.names = 1)
Sierra_CC_GO_terms <- read.csv('/Users/bryanmichalek/Documents/Notre_Dame/Spring 2021/Pfrender/GO_Custom_Annotations_Results/Sierra_all_genes/Sierra_all_genes_CC_GO_terms.csv', row.names = 1)
#--------------------------------------------------------------------------------------------------
#ALL BP WORK
#Filter for top 5 significant in each (get the 1st 5 rows...then take only the significant ones).
#They should already be in decreasing significance order.
Y05_BP_GO_top5 <- Y05_BP_GO_terms[1:5, ]
Y023_BP_GO_top5 <- Y023_BP_GO_terms[1:5, ]
E05_BP_GO_top5 <- E05_BP_GO_terms[1:5, ]
R2_BP_GO_top5 <- R2_BP_GO_terms[1:5, ]
PA_BP_GO_top5 <- PA_BP_GO_terms[1:5, ]
Sierra_BP_GO_top5 <- Sierra_BP_GO_terms[1:5, ]
Y05_BP_GO_sig <- Y05_BP_GO_top5[which(Y05_BP_GO_top5$p_adjusted <= 0.05), ]
Y023_BP_GO_sig <- Y023_BP_GO_top5[which(Y023_BP_GO_top5$p_adjusted <= 0.05), ]
E05_BP_GO_sig <- E05_BP_GO_top5[which(E05_BP_GO_top5$p_adjusted <= 0.05), ]
R2_BP_GO_sig <- R2_BP_GO_top5[which(R2_BP_GO_top5$p_adjusted <= 0.05), ]
PA_BP_GO_sig <- PA_BP_GO_top5[which(PA_BP_GO_top5$p_adjusted <= 0.05), ]
Sierra_BP_GO_sig <- Sierra_BP_GO_top5[which(Sierra_BP_GO_top5$p_adjusted <= 0.05), ]
#List of all 30 BP for each genotype (duplicates removed)
list_all_BP_GO_included <- unique(c(Y05_BP_GO_sig$GO.ID, Y023_BP_GO_sig$GO.ID, E05_BP_GO_sig$GO.ID,
R2_BP_GO_sig$GO.ID, PA_BP_GO_sig$GO.ID, Sierra_BP_GO_sig$GO.ID))
#Create tables with all the info for plot for each genotype
Y05_BP_plot_table <- Y05_BP_GO_terms[which(Y05_BP_GO_terms$GO.ID %in% list_all_BP_GO_included), ]
Y023_BP_plot_table <- Y023_BP_GO_terms[which(Y023_BP_GO_terms$GO.ID %in% list_all_BP_GO_included), ]
E05_BP_plot_table <- E05_BP_GO_terms[which(E05_BP_GO_terms$GO.ID %in% list_all_BP_GO_included), ]
R2_BP_plot_table <- R2_BP_GO_terms[which(R2_BP_GO_terms$GO.ID %in% list_all_BP_GO_included), ]
PA_BP_plot_table <- PA_BP_GO_terms[which(PA_BP_GO_terms$GO.ID %in% list_all_BP_GO_included), ]
Sierra_BP_plot_table <- Sierra_BP_GO_terms[which(Sierra_BP_GO_terms$GO.ID %in% list_all_BP_GO_included), ]
#Add a column labeling the genotype to each
Y05_BP_plot_table <- cbind("Genotype" = 'Y05', Y05_BP_plot_table)
Y023_BP_plot_table <- cbind("Genotype" = 'Y023', Y023_BP_plot_table)
E05_BP_plot_table <- cbind("Genotype" = 'E05', E05_BP_plot_table)
R2_BP_plot_table <- cbind("Genotype" = 'R2', R2_BP_plot_table)
PA_BP_plot_table <- cbind("Genotype" = 'PA', PA_BP_plot_table)
Sierra_BP_plot_table <- cbind("Genotype" = 'Sierra', Sierra_BP_plot_table)
#--------------------------------------------------------------------------------------------------
#ALL MF WORK
#Filter for top 5 significant in each (get the 1st 5 rows...then take only the significant ones).
#They should already be in decreasing significance order.
Y05_MF_GO_top5 <- Y05_MF_GO_terms[1:5, ]
Y023_MF_GO_top5 <- Y023_MF_GO_terms[1:5, ]
E05_MF_GO_top5 <- E05_MF_GO_terms[1:5, ]
R2_MF_GO_top5 <- R2_MF_GO_terms[1:5, ]
PA_MF_GO_top5 <- PA_MF_GO_terms[1:5, ]
Sierra_MF_GO_top5 <- Sierra_MF_GO_terms[1:5, ]
Y05_MF_GO_sig <- Y05_MF_GO_top5[which(Y05_MF_GO_top5$p_adjusted <= 0.05), ]
Y023_MF_GO_sig <- Y023_MF_GO_top5[which(Y023_MF_GO_top5$p_adjusted <= 0.05), ]
E05_MF_GO_sig <- E05_MF_GO_top5[which(E05_MF_GO_top5$p_adjusted <= 0.05), ]
R2_MF_GO_sig <- R2_MF_GO_top5[which(R2_MF_GO_top5$p_adjusted <= 0.05), ]
PA_MF_GO_sig <- PA_MF_GO_top5[which(PA_MF_GO_top5$p_adjusted <= 0.05), ]
Sierra_MF_GO_sig <- Sierra_MF_GO_top5[which(Sierra_MF_GO_top5$p_adjusted <= 0.05), ]
#List of all 30 MF for each genotype (duplicates removed)
list_all_MF_GO_included <- unique(c(Y05_MF_GO_sig$GO.ID, Y023_MF_GO_sig$GO.ID, E05_MF_GO_sig$GO.ID,
R2_MF_GO_sig$GO.ID, PA_MF_GO_sig$GO.ID, Sierra_MF_GO_sig$GO.ID))
#Create tables with all the info for plot for each genotype
Y05_MF_plot_table <- Y05_MF_GO_terms[which(Y05_MF_GO_terms$GO.ID %in% list_all_MF_GO_included), ]
Y023_MF_plot_table <- Y023_MF_GO_terms[which(Y023_MF_GO_terms$GO.ID %in% list_all_MF_GO_included), ]
E05_MF_plot_table <- E05_MF_GO_terms[which(E05_MF_GO_terms$GO.ID %in% list_all_MF_GO_included), ]
R2_MF_plot_table <- R2_MF_GO_terms[which(R2_MF_GO_terms$GO.ID %in% list_all_MF_GO_included), ]
PA_MF_plot_table <- PA_MF_GO_terms[which(PA_MF_GO_terms$GO.ID %in% list_all_MF_GO_included), ]
Sierra_MF_plot_table <- Sierra_MF_GO_terms[which(Sierra_MF_GO_terms$GO.ID %in% list_all_MF_GO_included), ]
#Add a column labeling the genotype to each
Y05_MF_plot_table <- cbind("Genotype" = 'Y05', Y05_MF_plot_table)
Y023_MF_plot_table <- cbind("Genotype" = 'Y023', Y023_MF_plot_table)
E05_MF_plot_table <- cbind("Genotype" = 'E05', E05_MF_plot_table)
R2_MF_plot_table <- cbind("Genotype" = 'R2', R2_MF_plot_table)
PA_MF_plot_table <- cbind("Genotype" = 'PA', PA_MF_plot_table)
Sierra_MF_plot_table <- cbind("Genotype" = 'Sierra', Sierra_MF_plot_table)
#--------------------------------------------------------------------------------------------------
#ALL CC WORK
#Filter for top 5 significant in each (get the 1st 5 rows...then take only the significant ones).
#They should already be in decreasing significance order.
Y05_CC_GO_top5 <- Y05_CC_GO_terms[1:5, ]
Y023_CC_GO_top5 <- Y023_CC_GO_terms[1:5, ]
E05_CC_GO_top5 <- E05_CC_GO_terms[1:5, ]
R2_CC_GO_top5 <- R2_CC_GO_terms[1:5, ]
PA_CC_GO_top5 <- PA_CC_GO_terms[1:5, ]
Sierra_CC_GO_top5 <- Sierra_CC_GO_terms[1:5, ]
Y05_CC_GO_sig <- Y05_CC_GO_top5[which(Y05_CC_GO_top5$p_adjusted <= 0.05), ]
Y023_CC_GO_sig <- Y023_CC_GO_top5[which(Y023_CC_GO_top5$p_adjusted <= 0.05), ]
E05_CC_GO_sig <- E05_CC_GO_top5[which(E05_CC_GO_top5$p_adjusted <= 0.05), ]
R2_CC_GO_sig <- R2_CC_GO_top5[which(R2_CC_GO_top5$p_adjusted <= 0.05), ]
PA_CC_GO_sig <- PA_CC_GO_top5[which(PA_CC_GO_top5$p_adjusted <= 0.05), ]
Sierra_CC_GO_sig <- Sierra_CC_GO_top5[which(Sierra_CC_GO_top5$p_adjusted <= 0.05), ]
#List of all 30 CC for each genotype (duplicates removed)
list_all_CC_GO_included <- unique(c(Y05_CC_GO_sig$GO.ID, Y023_CC_GO_sig$GO.ID, E05_CC_GO_sig$GO.ID,
R2_CC_GO_sig$GO.ID, PA_CC_GO_sig$GO.ID, Sierra_CC_GO_sig$GO.ID))
#Create tables with all the info for plot for each genotype
Y05_CC_plot_table <- Y05_CC_GO_terms[which(Y05_CC_GO_terms$GO.ID %in% list_all_CC_GO_included), ]
Y023_CC_plot_table <- Y023_CC_GO_terms[which(Y023_CC_GO_terms$GO.ID %in% list_all_CC_GO_included), ]
E05_CC_plot_table <- E05_CC_GO_terms[which(E05_CC_GO_terms$GO.ID %in% list_all_CC_GO_included), ]
R2_CC_plot_table <- R2_CC_GO_terms[which(R2_CC_GO_terms$GO.ID %in% list_all_CC_GO_included), ]
PA_CC_plot_table <- PA_CC_GO_terms[which(PA_CC_GO_terms$GO.ID %in% list_all_CC_GO_included), ]
Sierra_CC_plot_table <- Sierra_CC_GO_terms[which(Sierra_CC_GO_terms$GO.ID %in% list_all_CC_GO_included), ]
#Add a column labeling the genotype to each
Y05_CC_plot_table <- cbind("Genotype" = 'Y05', Y05_CC_plot_table)
Y023_CC_plot_table <- cbind("Genotype" = 'Y023', Y023_CC_plot_table)
E05_CC_plot_table <- cbind("Genotype" = 'E05', E05_CC_plot_table)
R2_CC_plot_table <- cbind("Genotype" = 'R2', R2_CC_plot_table)
PA_CC_plot_table <- cbind("Genotype" = 'PA', PA_CC_plot_table)
Sierra_CC_plot_table <- cbind("Genotype" = 'Sierra', Sierra_CC_plot_table)
#--------------------------------------------------------------------------------------------------
#Combine all tables into 1
all_genotype_BP_plot_table <- rbind(Y05_BP_plot_table, Y023_BP_plot_table, E05_BP_plot_table, R2_BP_plot_table, PA_BP_plot_table,
Sierra_BP_plot_table)
all_genotype_BP_plot_table <- cbind('GO_cat' = 'BP', all_genotype_BP_plot_table)
all_genotype_MF_plot_table <- rbind(Y05_MF_plot_table, Y023_MF_plot_table, E05_MF_plot_table, R2_MF_plot_table, PA_MF_plot_table,
Sierra_MF_plot_table)
all_genotype_MF_plot_table <- cbind('GO_cat' = 'MF', all_genotype_MF_plot_table)
all_genotype_CC_plot_table <- rbind(Y05_CC_plot_table, Y023_CC_plot_table, E05_CC_plot_table, R2_CC_plot_table, PA_CC_plot_table,
Sierra_CC_plot_table)
all_genotype_CC_plot_table <- cbind('GO_cat' = 'CC', all_genotype_CC_plot_table)
all_genotype_plot_table <- rbind(all_genotype_BP_plot_table, all_genotype_MF_plot_table, all_genotype_CC_plot_table)
#--------------------------------------------------------------------------------------------------
#Make plot
x_axis_order <- factor(all_genotype_plot_table$Genotype, levels = c('Y05', 'Y023', 'E05', 'R2', 'PA', 'Sierra'))
facet <- factor(all_genotype_plot_table$GO_cat, levels = c('BP', 'MF', 'CC'))
p <- ggplot(data = all_genotype_plot_table, aes(x = x_axis_order, y = Term, size = Significant, color = p_adjusted))
p <- p + facet_grid(rows = facet, space = 'free_y', scales = 'free')
p <- p + geom_point() + scale_color_gradientn(colors = heat.colors(10), limits=c(0, 0.05)) + theme_bw()
p <- p + xlab('Genotype') + ylab('GO Term')
p <- p + labs(color = 'Adjusted p-value', size = 'Gene rank')
#--------------------------------------------------------------------------------------------------
#Save to file
final_plot <- p
ggsave('GOenrich_Dotplot_CustomAnnotation_AllGenes.pdf', plot = final_plot, device = 'pdf')
file.move(paste(getwd(), '/', "GOenrich_Dotplot_CustomAnnotation_AllGenes.pdf", sep = ''), "/Users/bryanmichalek/Documents/Notre_Dame/Spring 2021/Pfrender/GO_Custom_Annotations_Results/", overwrite = TRUE)
